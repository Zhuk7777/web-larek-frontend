# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с TS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитектура приложения
В проекте реализовывается MVP архитектура  
В качестве посредника между моделью и отображением выступает брокер событий `EventEmitter`  


## Базовые классы

### `EventEmitter` обеспечивает работу событий
#### Поля
* _events - объект Map, который хранит названия событий и им соответствующие функции обратного вызова  
#### Методы
* constructor - инициализирует поле _events как пустой объект Map
* on - устанавливает обработчик на событие
* off - удаляет обработчик с события и удаляет событие, если обработчиков не осталось
* emit - инициирует событие с данными
* onAll - слушает все события
* offAll - сбрасывает все обработчики
* trigger - реализует коллбек триггер, генерирующий событие при вызове  

### `Api` предназначен для взаимодействия с сервером
#### Поля
* baseUrl - базовый URL
* options - параметры запроса
#### Методы
* constructor - инициализирует поля класса передаваемыми аргументами (baseUrl и options)
* handleResponse - обрабатывает ответ от сервера (успешно/ошибка)
* get - выполняет get запросы
* post - выполняет POST, PUT, DELETE запросы  


## Бизнес-логика. Классы модели

### `Model<T>` выступает в качестве абстрактного родительского класса для всех моделей в системе.
#### Методы
* constructor(data: Partial\<T\>, events: IEvents) -  конструктор, отвечающий за инициализацию модели данными и объектом событий.
* emit(event: string, data?: object) - генерирует события

### `AppModel` наследуется от абстрактного класса `Model` и реализует функциональные возможности приложения. Значением дженерика является интерфейс `IAppModel`.
#### Методы
* setCatalog - установка каталога товаров
* addCardToBasket - добавление товара в корзину
* removeCardFromBasket - удаление товара из корзины
* getBasketTotal - получение итоговый суммы по товарам в корзине
* getBasket - получение списка товаров, добавленных в корзину
* setPreview - установка данных для модального окна, которое обеспечивает предварительный просмотр товара
* setOrderField - сохранение данных поля заказа
* сlearBasket - очистка корзины
* clearOrder - очистка формы


## Отображение. Классы представления

### `View<T>` - интерфейс для всех представлений в приложении.
#### Поля
* container - контейнер представления
#### Методы
* constructor(container: HTMLElement) -  конструктор для инициализации представления.
* toggleClass(element: HTMLElement, className: string, force?: boolean): void - смена CSS класса элемента
* setText(element: HTMLElement, value: unknown): void - установка текстового содержимого элемента
* hideElement(element: HTMLElement): void - скрытие элемента
* showElement(element: HTMLElement): void - отображение элемента
* setImage(element: HTMLElement, src: string, alt?: string): void - установка изображения и опционально его альтернативного текста
* render(data?: T): HTMLElement - рендеринг представления с переданными данными

### `PageView` - класс наследник интерфейса `View<T>`. Значением дженерика является интерфейс `IPage`. Предназначен для отображения всей страницы.
#### Поля
* counterElement - элемент счетчика товаров в корзине
* catalogElement - элемент-контейнер для товаров
* wrapperElement - обертка для страницы
* basketElement - элемент корзины
#### Методы
* constructor(container: HTMLElement, protected events: IEvents) -  конструктор
#### Сеттеры
* counter - установка счетчика товаров в корзине
* catalog - установка списка товаров
* locked - блокировка скролла страницы

### `CardView<T>` - класс наследник интерфейса `View<T>`. Предназначен для отображения элемента товара.
#### Поля
* tittleElement - элемента заголовка
* priceElement - элемент цены
#### Методы
* constructor(container: HTMLElement) -  конструктор
#### Сеттеры
* title - установка заголовка карточки
* price - утсановка цены карточки
#### Геттеры
* title - получение заголовка карточки
* price - получение цены карточки

### `CatalogCardView` - класс наследник интерфейса `CardView<T>`. Значением дженерика является интерфейс `ICard`. Предназначен для отображения элемента товара в каталоге. Является наследником класса `CardView`
#### Поля
* imageElement - элемент изображения товара
* categoryElement - элемент категории товара
#### Методы
* constructor(container: HTMLElement, onClick: (event: MouseEvent) => void) -  конструктор
#### Сеттеры
* image - установка изображения
* category - установка категории
#### Геттеры
* image - получение изображения
* category - получение категории

### `PreviewCardView` - класс наследник интерфейса `CardView<T>`. Значением дженерика является `ICard & { status: boolean }`. Предназначен для отображения элемента товара в модальном окне предварительного просмотра. Является наследником класса `CardView`
#### Поля
* imageElement - элемент изображения товара
* categoryElement - элемент категории товара
* buttonElement - элемент кнопки добавления товара в корзину
* descriptionElement - элемент описания товара
#### Методы
* constructor(container: HTMLElement, onClick: (event: MouseEvent) => void) -  конструктор
#### Сеттеры
* image - установка изображения
* category - установка категории
* status - установка статуса кнопки
* description - установка описания товара
#### Геттеры
* image - получение изображения
* category - получение категории
* status - получение статуса кнопки
* description - получения описания товара

### `BasketCardView` - класс наследник интерфейса `CardView<T>`. Значением дженерика является `ICard & { index: number }`. Предназначен для отображения элемента товара в корзине. Является наследником класса `CardView`
#### Поля
* buttonElement - элемент кнопки удаления товара из корзины
* indexElement - элемент индекса товара
#### Методы
* constructor(container: HTMLElement, onClick: (event: MouseEvent) => void) -  конструктор
#### Сеттеры
* index - установка индекса товара
#### Геттеры
* index - получение индекса товара

### `ModalView` - класс наследник интерфейса `View<T>`. Значением дженерика является пустой объект. Предназначен для отображения модальных окон.
#### Поля
* closeButtonElement - элемент кнопки закрытия модального окна
* contentElement - элемент контента модального окна
#### Методы
* open - открытие модального окна
* close - закрытие модального окна
* render - рендеринг модального окна
#### Сеттеры
* content - установка контента модального окна

### `BasketView` - класс наследник интерфейса `View<T>`.  Значением дженерика является интерфейс `IBasket`. Предназначен для отображения корзины.
#### Поля
* listElement - элемент списка товаров в корзине
* priceElement - элемент цены товаров в корзине
#### Методы
* constructor(container: HTMLElement, protected events: EventEmitter) -  конструктор
#### Сеттеры
* items - установка списка товаров
* price - установка цены товаров

### `FormView<T>` - класс наследник интерфейса `View<T>`. Предназначен для отображения формы.
#### Поля
* submitElement - элемент кнопки отправки формы
* errorsElement - элемент ошибок формы
#### Методы
* constructor(protected container: HTMLFormElement, protected events: IEvents) -  конструктор
* onInputChange - обработчик изменений в полях ввода
* render - рендеринг формы
#### Сеттеры
* valid - установка состояния кнопки
* errors - установка ошибок

### `OrderView` - класс наследник интерфейса `FormView<T>`. Значением дженерика является `Omit<IOrderForm, 'phone' | 'email'>` Предназначен для отображения формы выбора способо оплаты и адреса.
#### Поля
* altButtonsElement - элемент кнопки выбора способо оплаты
#### Методы
* constructor(container: HTMLFormElement, events: IEvents) -  конструктор.
#### Сеттеры
* address - установка адреса
* method - утсановка способо оплаты

### `ContactsOrderView` - класс наследник интерфейса `FormView<T>`. Значением дженерика является `Omit<IOrderForm, 'address' | 'payment'>` Предназначен для отображения формы контактных данных.
#### Методы
* constructor(container: HTMLFormElement, events: IEvents) -  конструктор.
#### Сеттеры
* phone - установка номера телефона
* email - утсановка адреса электронной почты

### `SuccessView` - класс наследник интерфейса `View<T>`. Значением дженерика является интерфейс `ISuccess`. Предназначен для отображения модального окна успешного оформления заказа.
#### Поля
* descriptionElement - элемент описания
* closebutton - кнопка закрытия модального окна
#### Методы
* constructor(container: HTMLElement, onClick: () => void) -  конструктор
#### Сеттеры
* description - установка описания

## События

* catalog:change - изменение каталога товаров
* card:select - выбор карточки предварительного просмотра
* сard:addToBasket - добавление товара в корзину
* card:removeFromBasket - удаление товара из коризны
* modal:open - открытие модального окна
* modal:close - закрытие модального окна
* preview:change - изменение содержимого окна предваритерльного просмотра
* basket:open - открытие корзины
* order:open -  открытие формы заказа
* payment: set - установлен способ оплаты
* order:submit - отправлена форма способа оплаты и адреса
* order:clear - очистка формы
* contacts:sumbit - отправка формы контактных данных
* (order | contacts).(поле):change - изменение определенного поля
* paymentsFormErrors:change - ошибка формы выбора способа оплаты и адреса
* contactsFormErrors:change - ошибка формы контактных данных
